<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Palanter Demo</title>

    <!-- React and JQuery -->
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

    <!-- Opal and Hyperloop -->
    <script src="https://rawgit.com/ruby-hyperloop/hyperloop-js/master/opal-compiler.min.js"></script>
    <script src="https://rawgit.com/ruby-hyperloop/hyperloop-js/master/hyperloop.min.js"></script>

    <link href="https://rawgit.com/jonathancecil/palantir/8b8408591b1d901fa0a152afbb4285dfc2dc5eae/palantir.css" rel="stylesheet">
    <script type="text/javascript" src="https://rawgit.com/jonathancecil/palantir/5858f310e10ca954b8d2a66dc2a6405183bbe54f/palantir.js"></script>

    <script script type="text/ruby" src="components.rb"></script>

  </head>

  <body>
    <div data-hyperloop-mount="TopLevelComponent"></div>

    <div style="margin:10px;">
      <form id="choose" enctype="multipart/form-data" role="form">
        <p> Choose first file:
          <input id="file1" type="file" name="file1">
        </p>
        <p> Choose second file:
          <input id="file2" type="file" name="file2">
        </p>
      </form>
      <button onCLick="window.startComparison('comparison-document', 'changes-tree');">View Changes</button>
    </div>
    <p></p>
    <div style="margin:10px;">
      <div id="changes-tree"></div><div id="comparison-document"></div>
    </div>
    
  </body>

  <script type="text/javascript">

     /* You must provide the base URL of the compare server */
     var compareServerUrl = 'http://hybridcompare.azurewebsites.net';

     window.startComparison = function(pagesElementId, changesTreeId) {
       var xhr = new XMLHttpRequest();
       xhr.onload = function() {
         var comparisonUrl = compareServerUrl + xhr.getResponseHeader('location');
         var options = {
           comparisonUrl: comparisonUrl,
           pagesID: pagesElementId,
           changesTreeId: changesTreeId
         };
         window.palantirRenderComparison(options);
       };
       xhr.open('POST', window.compareServerUrl + '/api/compare', true);
       var formElement = document.getElementById('choose');
       xhr.send(new FormData(formElement));
       return false;
     };
   </script>

</html>
